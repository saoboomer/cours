<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PRONOTE Grade Analyzer</title>
    <link rel="stylesheet" href="styles_new.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body>
    <div id="app">
        <!-- Login Screen -->
        <div id="login-screen" class="screen active">
            <div class="login-container glass">
                <div class="logo">
                    <svg width="60" height="60" viewBox="0 0 60 60" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <circle cx="30" cy="30" r="28" fill="none" stroke="#ffffff" stroke-width="2"/>
                        <path d="M20 30L27 37L40 24" stroke="white" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </div>
                <h1>PRONOTE Grade Analyzer</h1>
                <p class="subtitle">Analyse avanc√©e avec IA ‚Ä¢ 10 m√©triques exclusives</p>
                
                <!-- School Selector -->
                <div class="school-selector">
                    <div class="selector-tabs">
                        <button type="button" class="selector-tab active" data-mode="search">üîç Rechercher</button>
                        <button type="button" class="selector-tab" data-mode="browse">üìç Parcourir</button>
                        <button type="button" class="selector-tab" data-mode="manual">‚öôÔ∏è Manuel</button>
                    </div>
                    
                    <!-- Search Mode -->
                    <div id="search-mode" class="selector-content active">
                        <div class="form-group" style="position: relative;">
                            <label for="school-search">Rechercher votre √©tablissement</label>
                            <input type="text" id="school-search" placeholder="Nom de l'√©cole ou ville...">
                            <div id="search-results" class="search-results" style="display: none;"></div>
                        </div>
                    </div>
                    
                    <!-- Browse Mode -->
                    <div id="browse-mode" class="selector-content">
                        <div class="form-group">
                            <label for="region-select">R√©gion</label>
                            <select id="region-select" class="select">
                                <option value="">S√©lectionner une r√©gion...</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="city-select">Ville</label>
                            <select id="city-select" class="select" disabled>
                                <option value="">S√©lectionner d'abord une r√©gion...</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="school-select">√âtablissement</label>
                            <select id="school-select" class="select" disabled>
                                <option value="">S√©lectionner d'abord une ville...</option>
                            </select>
                        </div>
                    </div>
                    
                    <!-- Manual Mode -->
                    <div id="manual-mode" class="selector-content">
                        <div class="form-group">
                            <label for="pronote-url">URL PRONOTE</label>
                            <input type="text" id="pronote-url" placeholder="https://demo.index-education.net/pronote/eleve.html">
                        </div>
                        <div class="form-group">
                            <label for="ent">ENT (optionnel)</label>
                            <input type="text" id="ent" placeholder="ac_rennes">
                            <small>Laissez vide si vous n'utilisez pas d'ENT</small>
                        </div>
                    </div>
                </div>
                
                <form id="login-form">
                    <div class="form-group">
                        <label for="username">Nom d'utilisateur</label>
                        <input type="text" id="username" placeholder="demonstration" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="password">Mot de passe</label>
                        <input type="password" id="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
                    </div>
                    
                    <button type="submit" class="btn btn-primary">
                        <span class="btn-text">Se connecter</span>
                        <span class="btn-loader" style="display: none;">
                            <div class="spinner"></div>
                        </span>
                    </button>
                    
                    <div id="login-error" class="error-message" style="display: none;"></div>
                </form>

                <!-- Offline JSON Loader -->
                <div class="form-group" style="margin-top: 1.5rem;">
                    <label>Ou charger un JSON local (offline)</label>
                    <div class="row" style="display: flex; gap: .5rem; align-items: center; margin-bottom: .5rem;">
                        <input type="file" id="offline-file" accept="application/json">
                        <button id="offline-load-file" type="button" class="btn btn-secondary btn-sm">Charger le fichier</button>
                        <button id="offline-load-text" type="button" class="btn btn-secondary btn-sm">Charger depuis la zone</button>
                    </div>
                    <textarea id="offline-textarea" placeholder="Collez votre JSON ici..." style="width: 100%; height: 140px;"></textarea>
                    <div id="offline-error" class="error-message" style="display:none; margin-top:.5rem;"></div>
                </div>
            </div>
        </div>

        <!-- Main Dashboard -->
        <div id="dashboard-screen" class="screen">
            <nav class="navbar">
                <div class="nav-brand">
                    <svg width="32" height="32" viewBox="0 0 60 60" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <circle cx="30" cy="30" r="28" fill="#4F46E5" stroke="#6366F1" stroke-width="2"/>
                        <path d="M20 30L27 37L40 24" stroke="white" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <span>PRONOTE Analyzer</span>
                </div>
                <div class="nav-user">
                    <span id="student-name">Chargement...</span>
                    <button id="logout-btn" class="btn btn-secondary btn-sm">D√©connexion</button>
                </div>
            </nav>

            <div class="container">
                <div class="tabs glass">
                    <button class="tab-btn active" data-tab="overview">üìä Vue d'ensemble</button>
                    <button class="tab-btn" data-tab="grades">üìù Notes</button>
                    <button class="tab-btn" data-tab="analysis">üî¨ Analyse</button>
                    <button class="tab-btn" data-tab="predictions">üéØ Pr√©dictions</button>
                    <button class="tab-btn" data-tab="advanced">üöÄ Analytics</button>
                </div>

                <!-- Overview Tab -->
                <div id="overview-tab" class="tab-content active">
                    <div class="stats-grid">
                        <div class="stat-card glass">
                            <div class="stat-icon">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#ffffff" stroke-width="2">
                                    <path d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z"/>
                                </svg>
                            </div>
                            <div class="stat-content">
                                <div class="stat-label">Moyenne g√©n√©rale</div>
                                <div class="stat-value" id="overall-average">--</div>
                            </div>
                        </div>

                        <div class="stat-card glass">
                            <div class="stat-icon">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#ffffff" stroke-width="2">
                                    <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/>
                                </svg>
                            </div>
                            <div class="stat-content">
                                <div class="stat-label">Moyenne de classe</div>
                                <div class="stat-value" id="class-average">--</div>
                            </div>
                        </div>

                        <div class="stat-card glass">
                            <div class="stat-icon">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#ffffff" stroke-width="2">
                                    <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                                    <polyline points="22 4 12 14.01 9 11.01"/>
                                </svg>
                            </div>
                            <div class="stat-content">
                                <div class="stat-label">Mati√®res suivies</div>
                                <div class="stat-value" id="subject-count">--</div>
                            </div>
                        </div>

                        <div class="stat-card glass">
                            <div class="stat-icon">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#ffffff" stroke-width="2">
                                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                                    <polyline points="14 2 14 8 20 8"/>
                                    <line x1="16" y1="13" x2="8" y2="13"/>
                                    <line x1="16" y1="17" x2="8" y2="17"/>
                                    <polyline points="10 9 9 9 8 9"/>
                                </svg>
                            </div>
                            <div class="stat-content">
                                <div class="stat-label">Total de notes</div>
                                <div class="stat-value" id="total-grades">--</div>
                            </div>
                        </div>
                    </div>

                    <div class="chart-container">
                        <h2>Comparaison des mati√®res</h2>
                        <canvas id="subjects-chart"></canvas>
                    </div>

                    <div class="subjects-list" id="subjects-comparison">
                        <!-- Will be populated dynamically -->
                    </div>
                </div>

                <!-- Grades Tab -->
                <div id="grades-tab" class="tab-content">
                    <div class="filters">
                        <select id="period-filter" class="select">
                            <option value="">Toutes les p√©riodes</option>
                        </select>
                        <select id="subject-filter" class="select">
                            <option value="">Toutes les mati√®res</option>
                        </select>
                    </div>

                    <div id="grades-list" class="grades-container">
                        <!-- Will be populated dynamically -->
                    </div>
                </div>

                <!-- Analysis Tab -->
                <div id="analysis-tab" class="tab-content">
                    <div class="analysis-section">
                        <h2>Statistiques par mati√®re</h2>
                        <div id="statistics-container">
                            <!-- Will be populated dynamically -->
                        </div>
                    </div>

                    <div class="analysis-section">
                        <h2>Tendances</h2>
                        <div id="trends-container">
                            <!-- Will be populated dynamically -->
                        </div>
                    </div>
                </div>

                <!-- Predictions Tab -->
                <div id="predictions-tab" class="tab-content">
                    <div class="prediction-tools">
                        <div class="tool-card">
                            <h3>Calculer la note n√©cessaire</h3>
                            <p>D√©couvrez quelle note obtenir pour atteindre votre objectif</p>
                            
                            <form id="needed-grade-form">
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Mati√®re</label>
                                        <select id="ng-subject" class="select" required>
                                            <option value="">S√©lectionner...</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label>Moyenne vis√©e (/20)</label>
                                        <input type="number" id="ng-target" step="0.01" min="0" max="20" required>
                                    </div>
                                </div>
                                
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Coefficient</label>
                                        <input type="number" id="ng-coef" step="0.1" min="0.1" value="1" required>
                                    </div>
                                    <div class="form-group">
                                        <label>Note sur</label>
                                        <input type="number" id="ng-outof" step="0.1" min="1" value="20" required>
                                    </div>
                                </div>
                                
                                <button type="submit" class="btn btn-primary">Calculer</button>
                            </form>
                            
                            <div id="needed-grade-result" class="result-box" style="display: none;">
                                <!-- Result will be shown here -->
                            </div>
                        </div>

                        <div class="tool-card">
                            <h3>Simuler plusieurs notes</h3>
                            <p>Calculez la moyenne n√©cessaire sur plusieurs √©valuations</p>
                            
                            <form id="simulate-grades-form">
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Mati√®re</label>
                                        <select id="sg-subject" class="select" required>
                                            <option value="">S√©lectionner...</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label>Moyenne vis√©e (/20)</label>
                                        <input type="number" id="sg-target" step="0.01" min="0" max="20" required>
                                    </div>
                                </div>
                                
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Nombre de notes</label>
                                        <input type="number" id="sg-num" min="1" value="3" required>
                                    </div>
                                    <div class="form-group">
                                        <label>Coefficient par note</label>
                                        <input type="number" id="sg-coef" step="0.1" min="0.1" value="1" required>
                                    </div>
                                </div>
                                
                                <button type="submit" class="btn btn-primary">Simuler</button>
                            </form>
                            
                            <div id="simulate-grades-result" class="result-box" style="display: none;">
                                <!-- Result will be shown here -->
                            </div>
                        </div>

                        <div class="tool-card">
                            <h3>What-if: ajouter une note</h3>
                            <p>Simulez l'impact d'une nouvelle note sur la moyenne</p>
                            <form id="whatif-form">
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Mati√®re</label>
                                        <select id="wi-subject" class="select" required>
                                            <option value="">S√©lectionner...</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label>Note</label>
                                        <input type="number" id="wi-grade" step="0.01" min="0" max="20" required>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Note sur</label>
                                        <input type="number" id="wi-outof" step="0.1" min="1" value="20" required>
                                    </div>
                                    <div class="form-group">
                                        <label>Coefficient</label>
                                        <input type="number" id="wi-coef" step="0.1" min="0.1" value="1" required>
                                    </div>
                                </div>
                                <button type="submit" class="btn btn-primary">Simuler</button>
                            </form>
                            <div id="whatif-result" class="result-box" style="display: none;"></div>
                        </div>
                    </div>
                </div>

                <!-- Advanced Analytics Tab -->
                <div id="advanced-tab" class="tab-content">
                    <h2 style="margin-bottom: 2rem; font-size: 2rem;">üöÄ Advanced Analytics</h2>
                    
                    <div class="stats-grid">
                        <div class="stat-card glass">
                            <div class="stat-content">
                                <div class="stat-label">GPA Projection</div>
                                <div class="stat-value" id="gpa-projection">--</div>
                                <small id="gpa-change" style="color: var(--text-secondary);"></small>
                            </div>
                        </div>
                        
                        <div class="stat-card glass">
                            <div class="stat-content">
                                <div class="stat-label">Strongest Correlation</div>
                                <div style="font-size: 1rem; color: var(--text-primary);" id="strongest-corr">--</div>
                            </div>
                        </div>
                    </div>

                    <div id="advanced-analytics-container">
                        <!-- Will be populated dynamically -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
